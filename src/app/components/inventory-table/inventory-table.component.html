<div class="contenedor row justify-content-between m-3" style="position: relative;">
    <div class="col-12 m-3 p-3 row">
        <div class="col-4 login-content">
            <form>
                <div class="input-div one">
                    <div class="i">
                      <i class="fas fa-search"></i>
                    </div>
                    <div class="div">
                      <input class="" type="text" placeholder="Producto, proveedor, marca..." [formControl]="filter">
                    </div>
                </div>
            </form>
        </div>
      <div class="col-8 d-flex" style="text-align-last: right;">
        <div class="col-3 mr-1 pt-3 pb-3" style="text-align-last: center;">
          <button class="btn-success m-3" style="width: fit-content;padding-left: 10px;padding-right: 10px;" *ngIf="_permisos.PERMISO_INSERCION==1" (click)="openModal(createProduct)"><i class="fas fa-plus"></i> Crear
            producto </button>
        </div>
        <div class="col-2 ml-1 pt-3 pb-3" style="text-align-last: center;">
          <button class="btn-general m-3" style="width: fit-content;padding-left: 10px;padding-right: 10px;" (click)="openModal(adminCategories)"><i class="fa fa-gear"></i> Categorías</button>
        </div>
        <div class="col-3 ml-1 pt-3 pb-3" style="text-align-last: center;">
          <button class="btn-general m-3" style="width: fit-content;padding-left: 10px;padding-right: 10px;" (click)="openModal(adminProviders)"><i class="fa fa-gear"></i> proveedores</button>
        </div>
      </div>
    </div>
  </div>

  <div class="col-12 p-3">
    <div class="col-12 contenedor pt-2 text-center">
        <div class="" style="width: auto; height: 600px; overflow: scroll;">
            <table class="table table-striped">
                <thead>
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">PRODUCTO</th>
                  <th scope="col">MARCA</th>
                  <th scope="col">DESCRIPCION</th>
                  <th scope="col">EXISTENCIA</th>
                  <th scope="col">PRECIO VENTA</th>
                  <th scope="col">PRECIO UNITARIO</th>
                  <th scope="col">CATEGORIA</th>
                  <th scope="col">PROVEEDOR</th>
                  <th scope="col">ESTADO</th>
                  <th scope="col">EDITAR</th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let pro of ProductsInter | async; index as i">
                  <th scope="row">{{ i + 1 }}</th>
                  <td><ngb-highlight [result]="pro.NOMBRE_PRODUCTO" [term]="filter.value"></ngb-highlight></td>
                  <td><ngb-highlight [result]="pro.MARCA_PRODUCTO" [term]="filter.value"></ngb-highlight></td>
                  <td><ngb-highlight [result]="pro.DESCRIPCION_PRODUCTO" [term]="filter.value"></ngb-highlight></td>
                  <td><ngb-highlight [result]="pro.EXISTENCIA | number" [term]="filter.value"></ngb-highlight></td>
                  <td><ngb-highlight [result]="pro.PRECIO_VENTA | number" [term]="filter.value"></ngb-highlight></td>
                  <td><ngb-highlight [result]="pro.PRECIO_UNITARIO | number" [term]="filter.value"></ngb-highlight></td>
                  <td><ngb-highlight [result]="pro.CATEGORIA" [term]="filter.value"></ngb-highlight></td>
                  <td><ngb-highlight [result]="pro.NOMBRE_PROVEEDOR" [term]="filter.value"></ngb-highlight></td>
                  <td>
                    <div *ngIf = "pro.ESTADO; else inactivo" class="form-check form-switch text-success">
                        <label class="form-check-label" for="flexSwitchCheckDefault">Activo</label>
                    </div>
                    <ng-template #inactivo>
                        <div class="form-check form-switch text-danger">
                            <label class="form-check-label" for="flexSwitchCheckDefault">Inactivo</label>
                        </div>
                    </ng-template>
                  </td>
                  <td><button class="btn btn-sm btn-outline-primary ms-2 p-2" *ngIf="_permisos.PERMISO_ACTUALIZACION==1" (mouseover)="openModl(pro.ID_PRODUCTO, pro.ESTADO, pro.ID_INVENTARIO)" (click)="openModal(editCard)"><i class="fas fa-pen"></i></button></td>
                </tr>
                </tbody>
              </table>
        </div>
    </div>
  </div>


  <!--Modal para crear producto-->
<ng-template #createProduct let-modal>
    <div class="modal-content">
      <div class="modal-body">
        <div class="modal-header d-flex justify-content-end p-3" style="text-align: center; display: block;">
          <button type="button" class="btn-general-close" (click)="modal.dismiss('Cross click')"></button>
        </div>
        <app-product (listaProductos)="crearProd($event)"></app-product>
        <div class="row pb-3">
          <p class="text-muted text-center">Sistema de Inventario Maelcon S de R. L.</p>
        </div>
      </div>
    </div>
  </ng-template>

  <!--Modal para administrar proveedores-->
  <ng-template #adminProviders let-modal>
    <div class="modal-content">
      <div class="modal-body">
        <div class="modal-header d-flex justify-content-end p-3" style="text-align: center; display: block;">
          <button type="button" class="btn-close" (click)="modal.dismiss('Cross click')"></button>
        </div>
        <app-providers></app-providers>
        <div class="row pb-3">
          <p class="text-muted text-center">Sistema de Inventario Maelcon S de R. L.</p>
        </div>
      </div>
    </div>
  </ng-template>

  <!--Modal para administrar proveedores-->
  <ng-template #adminCategories let-modal>
    <div class="modal-content">
      <div class="modal-body">
        <div class="modal-header d-flex justify-content-end p-3" style="text-align: center; display: block;">
          <button type="button" class="btn-close" (click)="modal.dismiss('Cross click')"></button>
        </div>
        <app-categories></app-categories>
        <div class="row pb-3">
          <p class="text-muted text-center">Sistema de Inventario Maelcon S de R. L.</p>
        </div>
      </div>
    </div>
  </ng-template>

  <!--Modal para actualizar-->
<ng-template #editCard let-modal>
    <div class="modal-content">
      <div class="modal-body">
        <div class="modal-header d-flex justify-content-end p-3" style="text-align: center; display: block;">
          <button type="button" class="btn-close" (click)="modal.dismiss('Cross click')"></button>
        </div>
        <div>
          <div class="row p-3">
            <div class="col-12 contenedor" style="text-align: center;  align-items: center; display: flex; background-color: #fff; border-radius: 15px;">
              <!--Cuadro contenedor de informacion-->
              <div class="car-inventary row " style="position: relative;">
                <div>
                  <h4 style="color: #0846ffff; margin-top: 20px;">{{datosProd.NOMBRE_PRODUCTO}}</h4>
                  <p class="text-muted">Actualización tarjeta de almacen</p>
                </div>

                <!--Columna 1 de informacion-->
                <div class="col-6 p-3">
                  <div class="login-content">
                    <form>
                      <div class="input-div one">
                        <div class="i">
                          <i class="fas fa-handshake"></i>
                        </div>
                        <div class="div">
                          <select class="form-control" placeholder="Proveedor" [(ngModel)]="datosProd.ID_PROVEEDOR" name="proveedor">
                            <option disabled>Seleccione proveedor</option>
                            <option *ngFor="let prov of _proveedores" [ngValue]="prov.ID_PROVEEDOR">{{prov.NOMBRE_PROVEEDOR}}</option>
                          </select>
                        </div>
                        <span class="text-muted details">Nombre del proveedor</span>
                      </div>

                      <div class="input-div one">
                        <div class="i">
                          <i class="fas fa-box"></i>
                        </div>
                        <div class="div">
                          <input class="" type="text" placeholder="Producto" [(ngModel)]="datosProd.NOMBRE_PRODUCTO" name="producto">
                        </div>
                        <span class="text-muted details">Nombre del producto</span>
                      </div>

                      <div class="input-div one">
                        <div class="i">
                          <i class="fas fa-flag"></i>
                        </div>
                        <div class="div">
                          <input class="" type="text" placeholder="Marca" [(ngModel)]="datosProd.MARCA_PRODUCTO" name="marca">
                        </div>
                        <span class="text-muted details">Marca</span>
                      </div>
                      <div class="input-div one">
                        <div class="i">
                          <i class="fas fa-sitemap"></i>
                        </div>
                        <div class="div">
                          <select class="form-control" placeholder="Categoria" [(ngModel)]="datosProd.ID_CATEGORIA" name="categoria">
                            <option disabled>Seleccione proveedor</option>
                            <option *ngFor="let cat of _categorias" [value]="cat.ID_CATEGORIA">{{cat.CATEGORIA}}</option>
                          </select>
                        </div>
                        <span class="text-muted details">Categoria</span>
                      </div>
                      <div class="input-div one">
                        <div class="i">
                          <i class="fas fa-info"></i>
                        </div>
                        <div class="div">
                          <input class="" type="text" placeholder="Descripcion" [(ngModel)]="datosProd.DESCRIPCION_PRODUCTO" name="descripcion">
                        </div>
                        <span class="text-muted details">Descripción</span>
                      </div>
                    </form>
                  </div>
                </div>
                <!--Columna 2 de informacion-->
                <div class="col-6" style="margin-top: 40px; margin-bottom: 40px; align-items: center;">
                  <div class="login-content">
                    <form>
                      <div class="input-div one">
                        <div class="i">
                          <i class="fas fa-file"></i>
                        </div>
                        <div class="div">
                          <input class="" type="file" placeholder="Imagen del producto" name="imagen">
                        </div>
                        <span class="text-muted details">Imagen del producto</span>
                      </div>

                      <div class="input-div one">
                        <div class="i">
                          <i class="fas fa-hashtag"></i>
                        </div>
                        <div class="div">
                          <input class="" type="number" step="1" placeholder="Existencia" [(ngModel)]="datosProdExist.EXISTENCIA" name="existencia" readonly>
                        </div>
                        <span class="text-muted details">Existencia en almacen</span>
                      </div>
                      <div class="input-div one">
                        <div class="i">
                          <i class="fas fa-coins"></i>
                        </div>
                        <div class="div">
                          <input class="" type="number" min="0.01" step="0.01" placeholder="Precio venta" [(ngModel)]="datosProdExist.PRECIO_VENTA" name="precioV">
                        </div>
                        <span class="text-muted details">Precio oficial de venta</span>
                      </div>
                      <div class="input-div one">
                        <div class="i">
                          <i class="fas fa-coins"></i>
                        </div>
                        <div class="div">
                          <input class="" type="number" step="0.01" placeholder="Precio Unitario Almacen" [(ngModel)]="datosProdExist.PRECIO_UNITARIO" name="precioU" readonly>
                        </div>
                        <span class="text-muted details">Precio unitario en almacen</span>
                      </div>
                      <div class="justify-content-center">
                        <span class="pt-2" style="position: absolute; font-size: 1.3rem;">
                          <div *ngIf="invValue; else inactivo" class="form-check form-switch text-success">
                            <input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault" checked
                              (click)="activOption(0)">
                            <label class="form-check-label" for="flexSwitchCheckDefault">Activo</label>
                          </div>
                          <ng-template #inactivo>
                            <div class="form-check form-switch text-danger">
                              <input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault"
                                (click)="activOption(1)">
                              <label class="form-check-label" for="flexSwitchCheckDefault">Inactivo</label>
                            </div>
                          </ng-template>
                        </span>
                      </div>
                    </form>
                  </div>
                </div>
                <div class="row justify-content-between">
                  <div class="col-6">
                    <input type="button" class="btn btn-cancel" value="Cancelar" (click)="modal.dismiss('Cross click')">
                  </div>
                  <div class="col-6">
                    <input type="button" class="btn-general" value="Actualizar" (click)="evaluarDatos()">
                  </div>
                </div>
                <div class="col-12 alert alert-danger" role="alert" *ngIf="enam">
                    {{msj}}
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row pb-3">
          <p class="text-muted text-center">Sistema de Inventario Maelcon S de R. L.</p>
        </div>
      </div>
    </div>
  </ng-template>
